<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>electro_mechanical_example</title>
<meta name="generator" content="MATLAB 24.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2024-11-18">
<meta name="DC.source" content="electro_mechanical_example.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#2">Import data</a>
</li>
<li>
<a href="#3">System Identification</a>
</li>
<li>
<a href="#4">Simulate model</a>
</li>
<li>
<a href="#5">Correlation based statistical validation OSA based</a>
</li>
<li>
<a href="#6">Correlation based statistical validation MPO based</a>
</li>
</ul>
</div>
<pre class="codeinput">clear;clc
addpath(<span class="string">'C:\Users\ae4159\OneDrive - Coventry University\PhD project\Matlab files\iFROs_PRESS'</span>);
<span class="comment">%NARX D1_thresh = 1e-12;</span>
<span class="comment">%ARX D1_thresh = 1e-10;</span>
</pre>
<h2 id="2">Import data</h2>
<pre class="codeinput">u = readmatrix(<span class="keyword">...</span>
    <span class="string">'C:\Users\ae4159\OneDrive - Coventry University\PhD project\Matlab files\iFROs_PRESS\Example\Electro-mecahnical system\x_cc.csv'</span>);
y = readmatrix(<span class="keyword">...</span>
    <span class="string">'C:\Users\ae4159\OneDrive - Coventry University\PhD project\Matlab files\iFROs_PRESS\Example\Electro-mecahnical system\y_cc.csv'</span>);

<span class="comment">%--- Down sample data ---%</span>
dwn_smpl = 100;
u = u(1:dwn_smpl:end);
y = y(1:dwn_smpl:end);
</pre>
<h2 id="3">System Identification</h2>
<pre class="codeinput">tt_splt = 100:350; <span class="comment">%Training data %1:10000;%500:1000;</span>
u_ID=u(tt_splt);
y_ID=y(tt_splt);

na1=1;na2=3;<span class="comment">%Set the maximum lags</span>
nb1=1;nb2=3;<span class="comment">%15%</span>
nl_ord_max=2;<span class="comment">%Set maximum order of noninearity</span>
is_bias=0;<span class="comment">%Set if a bias/DC offset is required</span>
n_inpts=1;inpt0=ones(1,n_inpts).*0;
RMO=3;
sim=[1,1];
displ=0;

tic
[model, Mod_Val_dat, iFRO_table_lin, iFRO_table_nl, best_mod_ind_lin, best_mod_ind_nl, val_stats]<span class="keyword">...</span>
    = sys_ID_NARX(u_ID,y_ID,na1,na2,nb1,nb2,nl_ord_max,is_bias,displ,sim,n_inpts,inpt0,RMO);
toc

disp(<span class="string">'ARX model:'</span>); disp(iFRO_table_lin{best_mod_ind_lin,1});
disp(<span class="string">'NARX model:'</span>); tbl_NARX = join(iFRO_table_nl{best_mod_ind_nl,10},<span class="keyword">...</span>
    iFRO_table_nl{best_mod_ind_nl,1});disp(tbl_NARX);
</pre>
<pre class="codeoutput">--------------------
MSSE = 3601.6419
MSkPE = 2017.5142
MSPE = 66.0511
--------------------
Elapsed time is 0.291572 seconds.
ARX model:
                  ERR         theta 
               __________    _______

    y1(t-1)     0.0035628     2.4274
    y1(t-2)    0.00010674    -1.9559
    y1(t-3)        0.9963    0.52645
    u1(t-1)    1.3124e-05     10.668
    u1(t-3)    3.8288e-06    -6.8021

NARX model:
                      MS_PRESS_E      theta         ERR    
                      __________    _________    __________

    y1(t-1)               8128.5       1.7844       0.49526
    y1(t-2)               975.85     -0.79156    0.00028497
    u1(t-1)               318.88       47.205    2.6363e-05
    y1(t-2)u1(t-1)        158.23    -0.037612     6.211e-06
    y1(t-3)u1(t-1)    1.2306e+07     0.030086       0.50441
    u1(t-2)u1(t-2)        91.271         1.89    2.5147e-06
    u1(t-2)u1(t-3)        71.842     -0.91694    7.2261e-07

</pre>
<img vspace="5" hspace="5" src="electro_mechanical_example_01.png" alt=""> <h2 id="4">Simulate model</h2>
<pre class="codeinput">[sse, y_hat, error, U_delay_mat_sim] = model_simulation(model,u,y,20);
disp([<span class="string">'RMSE = '</span>,num2str( sqrt(mean(error(:,1).^2)) )]);
disp([<span class="string">'Error variance = '</span>,num2str( var(error(:,1)) )]);

<span class="comment">%----------</span>
figure;
subplot(2,1,1); plot(u, <span class="string">'Color'</span>, <span class="string">'#0072BD'</span>);
ylabel(<span class="string">'$u(t)$'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12);
<span class="comment">%----------</span>
n = length(y);
subplot(2,1,2);
plot(1:n, y,<span class="string">'Color'</span>, <span class="string">'#77AC30'</span>, <span class="string">'LineWidth'</span>,1.5); hold <span class="string">on</span>;
plot(tt_splt, y_ID, <span class="string">'Color'</span>, <span class="string">'#EDB120'</span>,<span class="string">'LineWidth'</span>,1.5); hold <span class="string">on</span>;
plot((length(y)-length(y_hat)+1:n), y_hat(:,3), <span class="string">'k-.'</span>, <span class="string">'LineWidth'</span>,1.25);
legend(<span class="string">'$y(t)$ -- testing'</span>, <span class="string">'$y(t)$ -- training'</span>,<span class="string">'$\hat{y}(t)$ -- model simulation'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12);
xlabel(<span class="string">'Time Samples'</span>);
ylabel(<span class="string">'$y(t)/\hat{y}(t)$'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'FontSize'</span>,12);
<span class="comment">%----------</span>
</pre>
<pre class="codeoutput">RMSE = 177.6604
Error variance = 26015.6385
</pre>
<img vspace="5" hspace="5" src="electro_mechanical_example_02.png" alt=""> <h2 id="5">Correlation based statistical validation OSA based</h2>
<pre class="codeinput">e_ct = error(tt_splt,1);
u_ct = U_delay_mat_sim(tt_splt,1);
u_ct = u_ct - mean(u_ct);
u_ct = u_ct ./ std(u_ct);
e_ct = e_ct - mean(e_ct);
e_ct = e_ct ./ std(e_ct);
[~,~] = ac_cc_model_valid_nl(e_ct,u_ct,200,1);
</pre>
<img vspace="5" hspace="5" src="electro_mechanical_example_03.png" alt=""> <h2 id="6">Correlation based statistical validation MPO based</h2>
<pre class="codeinput">e_ct = error(tt_splt,2);
u_ct = U_delay_mat_sim(tt_splt,1);
u_ct = u_ct - mean(u_ct);
u_ct = u_ct ./ std(u_ct);
e_ct = e_ct - mean(e_ct);
e_ct = e_ct ./ std(e_ct);
[~,~] = ac_cc_model_valid_nl(e_ct,u_ct,100,1);
</pre>
<img vspace="5" hspace="5" src="electro_mechanical_example_04.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
clear;clc
addpath('C:\Users\ae4159\OneDrive - Coventry University\PhD project\Matlab files\iFROs_PRESS');
%NARX D1_thresh = 1e-12;
%ARX D1_thresh = 1e-10;
%% Import data 

u = readmatrix(...
    'C:\Users\ae4159\OneDrive - Coventry University\PhD project\Matlab files\iFROs_PRESS\Example\Electro-mecahnical system\x_cc.csv');
y = readmatrix(...
    'C:\Users\ae4159\OneDrive - Coventry University\PhD project\Matlab files\iFROs_PRESS\Example\Electro-mecahnical system\y_cc.csv');

%REPLACE_WITH_DASH_DASH- Down sample data REPLACE_WITH_DASH_DASH-%
dwn_smpl = 100;
u = u(1:dwn_smpl:end);
y = y(1:dwn_smpl:end);
%% System Identification
tt_splt = 100:350; %Training data %1:10000;%500:1000;
u_ID=u(tt_splt);
y_ID=y(tt_splt);

na1=1;na2=3;%Set the maximum lags
nb1=1;nb2=3;%15%
nl_ord_max=2;%Set maximum order of noninearity 
is_bias=0;%Set if a bias/DC offset is required
n_inpts=1;inpt0=ones(1,n_inpts).*0;
RMO=3;
sim=[1,1];
displ=0;

tic
[model, Mod_Val_dat, iFRO_table_lin, iFRO_table_nl, best_mod_ind_lin, best_mod_ind_nl, val_stats]...
    = sys_ID_NARX(u_ID,y_ID,na1,na2,nb1,nb2,nl_ord_max,is_bias,displ,sim,n_inpts,inpt0,RMO);
toc

disp('ARX model:'); disp(iFRO_table_lin{best_mod_ind_lin,1});
disp('NARX model:'); tbl_NARX = join(iFRO_table_nl{best_mod_ind_nl,10},...
    iFRO_table_nl{best_mod_ind_nl,1});disp(tbl_NARX);
%% Simulate model
[sse, y_hat, error, U_delay_mat_sim] = model_simulation(model,u,y,20);
disp(['RMSE = ',num2str( sqrt(mean(error(:,1).^2)) )]);
disp(['Error variance = ',num2str( var(error(:,1)) )]);

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
figure;
subplot(2,1,1); plot(u, 'Color', '#0072BD');
ylabel('$u(t)$','Interpreter','latex','FontSize',12);
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
n = length(y);
subplot(2,1,2);
plot(1:n, y,'Color', '#77AC30', 'LineWidth',1.5); hold on;
plot(tt_splt, y_ID, 'Color', '#EDB120','LineWidth',1.5); hold on;
plot((length(y)-length(y_hat)+1:n), y_hat(:,3), 'k-.', 'LineWidth',1.25);
legend('$y(t)$ REPLACE_WITH_DASH_DASH testing', '$y(t)$ REPLACE_WITH_DASH_DASH training','$\hat{y}(t)$ REPLACE_WITH_DASH_DASH model simulation','Interpreter','latex','FontSize',12);
xlabel('Time Samples');
ylabel('$y(t)/\hat{y}(t)$','Interpreter','latex','FontSize',12);
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% Correlation based statistical validation OSA based 
e_ct = error(tt_splt,1);
u_ct = U_delay_mat_sim(tt_splt,1);
u_ct = u_ct - mean(u_ct);
u_ct = u_ct ./ std(u_ct);
e_ct = e_ct - mean(e_ct);
e_ct = e_ct ./ std(e_ct);
[~,~] = ac_cc_model_valid_nl(e_ct,u_ct,200,1);

%% Correlation based statistical validation MPO based
e_ct = error(tt_splt,2);
u_ct = U_delay_mat_sim(tt_splt,1);
u_ct = u_ct - mean(u_ct);
u_ct = u_ct ./ std(u_ct);
e_ct = e_ct - mean(e_ct);
e_ct = e_ct ./ std(e_ct);
[~,~] = ac_cc_model_valid_nl(e_ct,u_ct,100,1);




##### SOURCE END #####
-->
</body>
</html>
